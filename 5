#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>
#define MAX 100
struct Stack {
    char arr[MAX];
    int top;
};
void initStack(struct Stack *s){
    s->top=-1;
}
int isEmpty(struct Stack *s){
    return s-> top==-1;
}
int isFull(struct Stack *s){
    return s->top==MAX-1;
}
void push(struct Stack *s, char item){
    if(isFull(s)){
        printf("Stack Overflow\n");
        return;
    }
    s->arr[++(s->top)]=item;
}
char pop(struct Stack *s){
    if(isEmpty(s)){
        printf("Stack Underflow\n");
        return '\0';
    }
    return s->arr[(s->top)--];
}
char peek(struct Stack *s){
    if(isEmpty(s)) return'\0';
    return s->arr[s->top];
}
int precedence(char op){
    switch(op){
        case '^':return 3;
        case '*':
        case '/':
        case '%':return 2;
        case '+':
        case '-':return 1;
        default:return 0;
    }
}
int isRightAssociative(char op){
    return (op=='^');
}
int isOperator(char ch){
    return(ch=='+'||ch=='-'||ch=='*'||ch=='/'||ch=='%'||ch=='^');
}
void infixToPostfix(char *infix, char *postfix){
    struct Stack s;
    initStack(&s);
    int i,k=0;
    char ch;

    for(i=0;infix[i]!='\0';i++){
        ch=infix[i];
        if(isalnum(ch)){
            postfix[k++]=ch;
        }
        else if(ch=='('){
            push(&s,ch);
        }
        else if(ch==')'){
            while(!isEmpty(&s)&&peek(&s)!='('){
                postfix[k++]=pop(&s);
            }
            if(!isEmpty(&s)&&peek(&s)=='(')
                pop(&s);
        }
        else if(isOperator(ch)){
            while(!isEmpty(&s)&& isOperator(peek(&s))&&((precedence(ch)<precedence(peek(&s)))||(precedence(ch)==precedence(peek(&s))&&!isRightAssociative(ch)))){
                postfix[k++]=pop(&s);
            }
            push(&s,ch);
        }
    }
    while(!isEmpty(&s)){
        postfix[k++]=pop(&s);
    }
    postfix[k]='\0';
}
int main()
{
    char infix[MAX], postfix[MAX];
    printf("Enter Infix Expression:");
    scanf("%s",infix);
    infixToPostfix(infix, postfix);
    printf("Postfix Expression: %s\n",postfix);
    return 0;
}
