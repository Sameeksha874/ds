#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <math.h>
#define MAX 100

typedef struct{
    char arr[MAX];
    int top;
}Stack;
void init(Stack *s){
    s->top=-1;
}
int isEmpty(Stack *s){
    return s->top==-1;
}
int isFull(Stack *s){
    return s->top==MAX-1;
}

void push(Stack *s, int item){
    if(isFull(s)){
        printf("Stack Overflow\n");
        exit(1);
    }
    s->arr[++(s->top)]=item;
}
int pop(Stack *s){
    if(isEmpty(s)){
        printf("Stack Underflow\n");
        exit(1);
    }
    return s->arr[(s->top)--];
}

int evaluatePostfix(char postfix[]){
    Stack s;
    init(&s);
    for(int i=0; postfix[i]!='\0'; i++){
        char ch=postfix[i];
        if (isdigit(ch)){
            push(&s, ch - '0');
        }
        else{
            int val2=pop(&s);
            int val1=pop(&s);

            switch(ch){
                case '+':push(&s, val1+val2); break;
                case '-':push(&s, val1-val2); break;
                case '*':push(&s, val1*val2); break;
                case '/':push(&s, val1/val2); break;
                case '%':push(&s, val1%val2); break;
                case '^':push(&s, (int)pow(val1, val2)); break;
                default: printf("Invalid operator encountered:%c\n",ch);
                exit(1);
            }
        }
    }
    return pop(&s);
}
void towerofHanoi(int n, char src, char aux, char des){
    if(n==1){
        printf("Move disk 1 from %c to %c\n",src,des);
        return;
    }
    towerofHanoi(n-1,src,des,aux);
    printf("Move disk %d from %c to %c\n", n,src, des);
    towerofHanoi(n-1,aux,src,des);
}

int main()
{
    int choice;
    while (1){
        printf("\n-----Stack Applications-----\n");
        printf("1.Evaluate Postfix Expression\n");
        printf("2.Solve Tower of Hanoi\n");
        printf("3.Exit\n");
        printf("Enter your choice:");
        scanf("%d", &choice);
        if(choice==1){
            char postfix[MAX];
            printf("Enter postfix expression (single digit operands):");
            scanf("%s",postfix);
            int result=evaluatePostfix(postfix);
            printf("Result=%d\n",result);
        }
        else if (choice==2){
            int n;
            printf("Enter number of disks:");
            scanf("%d",&n);
            printf("\nThe sequence of moves:\n");
            towerofHanoi(n,'A','B','C');
            printf("Total moves required=%d\n",(1<<n)-1);
        }
        else if(choice==3){
            printf("Exiting....\n");
            break;
        }
        else{
            printf("Invalid choice! Try Again\n");
        }
    }
    return 0;
}
